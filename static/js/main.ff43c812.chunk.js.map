{"version":3,"sources":["components/useIsMainWindow.js","components/Header.jsx","api/api.js","state/actions.js","components/SignedInUser.jsx","components/Main.jsx","components/ConfirmIsMain.jsx","components/App.jsx","state/reducers/index.js","state/reducers/authReducer.js","state/reducers/signinStatusReducer.js","index.js"],"names":["useIsMainWindow","initialized","useRef","isNewWindowPromotedToMain","windowId","useState","isMain","setIsMain","getWindowArray","storage","window","localStorage","getItem","JSON","parse","setWindowArray","data","setItem","stringify","determineWindowState","windowArray","current","length","newWindowArray","setTimeout","removeWindow","i","splice","useEffect","addEventListener","Date","now","toString","removeEventListener","Header","className","API","axios","create","baseURL","signIn","result","post","logOut","email","logOutOthers","dispatch","a","api","response","type","payload","console","log","SignedInUser","useDispatch","useSelector","state","authReducer","name","token","authenticatedUser","setAuthenticatedUser","status","newUser","existingUser","onClick","Main","isLoggedin","signinStateReducer","localUser","clientId","render","renderProps","disabled","onSuccess","res","tokenId","profileObj","onFailure","error","cookiePolicy","ConfirmIsMain","location","reload","App","combineReducers","action","removeItem","store","createStore","reducers","compose","applyMiddleware","thunk","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.ff43c812.chunk.js","sourcesContent":["import { useState, useEffect, useRef } from \"react\";\r\n\r\n\r\nconst useIsMainWindow = () => {\r\n\r\n    const initialized = useRef(false);\r\n    const isNewWindowPromotedToMain = useRef(false);\r\n    const windowId = useRef(null);\r\n    const [isMain, setIsMain] = useState(true);\r\n\r\n    const getWindowArray = () => {\r\n        let storage = window.localStorage.getItem(\"checkTab\");\r\n        return storage ? JSON.parse(storage) : [];\r\n    };\r\n\r\n    const setWindowArray = (data) => {\r\n        window.localStorage.setItem(\"checkTab\", JSON.stringify(data));\r\n    };\r\n\r\n    const determineWindowState = () => {\r\n        let windowArray = getWindowArray();\r\n\r\n        if (initialized.current) {\r\n            if (\r\n                windowArray.length <= 1 ||\r\n                (isNewWindowPromotedToMain.current\r\n                    ? windowArray[windowArray.length - 1]\r\n                    : windowArray[0]) === windowId.current\r\n            ) {\r\n                setIsMain(true);\r\n            } else {\r\n                setIsMain(false);\r\n            }\r\n        } else {\r\n            if (windowArray.length === 0) {\r\n                setIsMain(true);\r\n            } else {\r\n                setIsMain(false);\r\n            }\r\n            const newWindowArray = [...windowArray, windowId.current];\r\n            setWindowArray(newWindowArray);\r\n        }\r\n\r\n        setTimeout(function () {\r\n            determineWindowState();\r\n        }, 100);\r\n    };\r\n\r\n    const removeWindow = () => {\r\n        var newWindowArray = getWindowArray();\r\n        for (var i = 0, length = newWindowArray.length; i < length; i++) {\r\n            if (newWindowArray[i] === windowId.current) {\r\n                newWindowArray.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n        setWindowArray(newWindowArray);\r\n    };\r\n\r\n    useEffect(() => {\r\n        window.addEventListener(\"beforeunload\", removeWindow);\r\n        window.addEventListener(\"unload\", removeWindow);\r\n        isNewWindowPromotedToMain.current = true;\r\n        windowId.current = Date.now().toString();\r\n        determineWindowState();\r\n        initialized.current = true;\r\n\r\n        return () => {\r\n            window.removeEventListener(\"beforeunload\", removeWindow);\r\n            window.removeEventListener(\"unload\", removeWindow);\r\n        };\r\n    }, []);\r\n\r\n    return isMain;\r\n};\r\n\r\nexport default useIsMainWindow;\r\n","import React from 'react';\r\n\r\nexport default function Header() {\r\n    return (\r\n        <div className=\"header\">\r\n            <h1>Single Login App</h1>\r\n        </div>\r\n    )\r\n}","import axios from 'axios';\r\n\r\nconst API = axios.create({ baseURL: 'https://single-login-app-nodejs.herokuapp.com/users' });\r\n\r\nexport const signIn = (result) => API.post('/signin', result);\r\nexport const logOut = (email) => API.post('/signout', email);\r\nexport const logOutOthers = (result) => API.post('/signoutothers', result);","import * as api from '../api/api.js';\r\n\r\nexport const signIn = (result) => async (dispatch) => {\r\n    try {\r\n        const response = await api.signIn(result);\r\n        dispatch({ type: 'SIGNIN', payload: response });\r\n        dispatch({ type: 'SIGN_IN_STATE', payload: true });\r\n    } catch (error) {\r\n        console.log(error)\r\n    }\r\n}\r\nexport const logOut = (email) => async (dispatch) => {\r\n    await api.logOut(email);\r\n    dispatch({ type: 'LOGOUT', payload: [] });\r\n    dispatch({ type: 'SIGN_OUT_STATE', payload: false });\r\n}\r\n\r\nexport const logOutOthers = (result) => async (dispatch) => {\r\n    try {\r\n        const response = await api.logOutOthers(result);\r\n        dispatch({ type: 'SIGNIN', payload: response });\r\n        dispatch({ type: 'SIGN_IN_STATE', payload: true });\r\n    } catch (error) {\r\n        console.log(error)\r\n    }\r\n}","import React, { useState, useEffect, useRef } from 'react';\r\n\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { logOut, logOutOthers } from '../state/actions.js';\r\n\r\n\r\nexport default function SignedInUser() {\r\n    const dispatch = useDispatch();\r\n    let result = useSelector((state) => state.authReducer);\r\n    console.log(result);\r\n\r\n    const name = useRef();\r\n    const email = useRef();\r\n    const token = useRef();\r\n    const [authenticatedUser, setAuthenticatedUser] = useState();\r\n\r\n    useEffect(() => {\r\n        if (result?.status === 200) {\r\n            if (result.data.newUser) {\r\n                name.current = result.data.newUser.name;\r\n                email.current = result.data.newUser.email;\r\n                token.current = result.data.newUser.token;\r\n\r\n            } else if (result.data.existingUser) {\r\n                name.current = result.data.existingUser.name;\r\n                email.current = result.data.existingUser.email;\r\n                token.current = result.data.existingUser.token;\r\n            }\r\n            setAuthenticatedUser(true);\r\n        } else if (result?.status === 201) {\r\n            if (result.data.existingUser) {\r\n                name.current = result.data.existingUser.name;\r\n                email.current = result.data.existingUser.email;\r\n                token.current = result.data.existingUser.token;\r\n            }\r\n            setAuthenticatedUser(false)\r\n        }\r\n    }, [result])\r\n\r\n    function handleLogout() {\r\n        dispatch(logOut({ email: email.current }));\r\n    }\r\n    function handleLogoutOthers() {\r\n        result = { name: name.current, email: email.current, token: token.current };\r\n        dispatch(logOutOthers(result));\r\n    }\r\n\r\n    return (\r\n        <div className=\"user\">\r\n            {authenticatedUser ?\r\n                <div className=\"authenticated-user\">\r\n                    <p className=\"login-success\">Signed In</p>\r\n                    <div className=\"user-details\">\r\n                        <div>\r\n                            <p className=\"small-text\">Name</p>\r\n                            <p className=\"user-name\">{name.current}</p>\r\n                        </div>\r\n                        <div>\r\n                            <p className=\"small-text\">Email</p>\r\n                            <p className=\"user-name\">{email.current}</p>\r\n                        </div>\r\n                    </div>\r\n                    <button className=\"button button-reject\" onClick={handleLogout}>Log Out</button>\r\n                </div>\r\n                :\r\n                <div className=\"authenticated-user\">\r\n                    <p className=\"login-success\">Can not Sign In</p>\r\n                    <div className=\"user-details\">\r\n                        <p className=\"confirm-signout-others-msg\">{name.current}, you are logged in somewhere else. Log out and Sign In here instead ?</p>\r\n                    </div>\r\n                    <button className=\"button button-reject\" onClick={handleLogoutOthers}>Log Out</button>\r\n                </div>\r\n            }\r\n        </div>\r\n    )\r\n}","import React, { useEffect } from 'react';\r\nimport GoogleLogin from 'react-google-login';\r\nimport SignedInUser from './SignedInUser.jsx';\r\n\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { signIn } from '../state/actions.js';\r\n\r\nexport default function Main() {\r\n    const dispatch = useDispatch();\r\n    const isLoggedin = useSelector((state) => state.signinStateReducer)\r\n\r\n    function googleSucces(res) {\r\n        const token = res?.tokenId;\r\n        const { name, email } = res?.profileObj;\r\n        const result = { name: name, email: email, token: token }\r\n        dispatch(signIn(result));\r\n    }\r\n    function googleFailure(error) {\r\n        console.log('Google Sign In failed');\r\n        console.log(error);\r\n    }\r\n    useEffect(() => {\r\n        const localUser = JSON.parse(localStorage.getItem(\"singleLoginSession\"));\r\n        let result = {};\r\n        if (localUser) {\r\n            if (localUser?.status === 200) {\r\n                if (localUser.data.newUser) {\r\n                    const { name, email, token } = localUser.data.newUser;\r\n                    result = { name: name, email: email, token: token }\r\n\r\n                } else if (localUser.data.existingUser) {\r\n                    const { name, email, token } = localUser.data.existingUser;\r\n                    result = { name: name, email: email, token: token }\r\n                }\r\n            }\r\n            dispatch(signIn(result));\r\n        }\r\n    }, [])\r\n\r\n    return (\r\n        <div className=\"main\">\r\n            {!isLoggedin ?\r\n                <GoogleLogin\r\n                    clientId=\"580735389692-2mne57mpso945clqafp28j9g2828e0ir.apps.googleusercontent.com\"\r\n                    render={(renderProps) => (\r\n                        <button className=\"button googleButton\" onClick={renderProps.onClick} disabled={renderProps.disabled} >\r\n                            Sign In with Google\r\n                        </button>\r\n                    )} onSuccess={googleSucces} onFailure={googleFailure} cookiePolicy={\"single_host_origin\"}\r\n                />\r\n                :\r\n                <SignedInUser />\r\n            }\r\n        </div>\r\n    )\r\n}","import React from 'react';\r\n\r\nexport default function ConfirmIsMain() {\r\n\r\n    function handleConfirm() {\r\n        window.location.reload();\r\n    }\r\n\r\n    return (\r\n        <div className=\"confirm-is-main\">\r\n            <p className=\"confirm-is-main-para\">\r\n                This app can only be used in one Tab at a time. Would you like to use the current tab instead ?\r\n            </p>\r\n            <div className=\"confirm-is-main-buttondiv\">\r\n                <button className=\"button button-confirm\" onClick={handleConfirm}>Yes</button>\r\n            </div>\r\n        </div>\r\n    )\r\n}","import React from 'react';\r\nimport useIsMainWindow from './useIsMainWindow.js';\r\nimport Header from './Header.jsx';\r\nimport Main from './Main.jsx';\r\nimport ConfirmIsMain from './ConfirmIsMain.jsx';\r\n\r\n\r\nexport default function App() {\r\n    const isMain = useIsMainWindow();\r\n\r\n    return (\r\n        <div className=\"app\">\r\n            <Header />\r\n            <div className=\"container\">\r\n                {isMain ?\r\n                    <Main /> :\r\n                    <ConfirmIsMain />}\r\n            </div>\r\n\r\n        </div>\r\n    )\r\n}","import { combineReducers } from 'redux';\r\n\r\nimport authReducer from './authReducer.js';\r\nimport signinStateReducer from './signinStatusReducer.js';\r\n\r\nexport default combineReducers({ authReducer, signinStateReducer });","export default function authReducer(state = [], action) {\r\n    switch (action.type) {\r\n        case 'SIGNIN':\r\n            localStorage.setItem(\"singleLoginSession\", JSON.stringify({ ...action?.payload }));\r\n            return action.payload;\r\n        case 'LOGOUT':\r\n            localStorage.removeItem(\"singleLoginSession\");\r\n            return action.payload;\r\n        default:\r\n            return state;\r\n    }\r\n}","export default function signinStateReducer(state = false, action) {\r\n    switch (action.type) {\r\n        case 'SIGN_IN_STATE':\r\n            return action.payload;\r\n        case 'SIGN_OUT_STATE':\r\n            return action.payload;\r\n        default:\r\n            return state;\r\n    }\r\n}","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './components/App.jsx';\r\nimport reducers from './state/reducers';\r\n\r\nimport { Provider } from 'react-redux';\r\nimport { applyMiddleware, compose, createStore } from 'redux';\r\nimport thunk from 'redux-thunk';\r\n\r\nconst store = createStore(reducers, compose(applyMiddleware(thunk)));\r\n\r\nReactDOM.render(\r\n    <Provider store={store}>\r\n        <App />\r\n    </Provider>\r\n    , document.getElementById('root'))"],"sourceRoot":""}